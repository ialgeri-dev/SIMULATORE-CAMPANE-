<!-- Schermata iniziale con tastierino -->
<div id="schermata-accesso">
  <h2 style="text-align:center;">Inserisci il codice</h2>
  <div id="display-codice" style="text-align:center; font-size:24px; margin-bottom:20px;">____</div>
  <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:10px; max-width:200px; margin:0 auto;">
    <button class="tasto" onclick="inserisciNumero('1')">1</button>
    <button class="tasto" onclick="inserisciNumero('2')">2</button>
    <button class="tasto" onclick="inserisciNumero('3')">3</button>
    <button class="tasto" onclick="inserisciNumero('4')">4</button>
    <button class="tasto" onclick="inserisciNumero('5')">5</button>
    <button class="tasto" onclick="inserisciNumero('6')">6</button>
    <button class="tasto" onclick="inserisciNumero('7')">7</button>
    <button class="tasto" onclick="inserisciNumero('8')">8</button>
    <button class="tasto" onclick="inserisciNumero('9')">9</button>
    <button class="tasto" onclick="cancellaCodice()">‚Üê</button>
    <button class="tasto" onclick="inserisciNumero('0')">0</button>
    <button class="tasto" onclick="verificaCodice()">OK</button>
  </div>
</div>

<style>
  #schermata-accesso {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: #f2f2f2;
    z-index: 9999;
    padding-top: 100px;
  }

  .tasto {
    width: 60px;
    height: 60px;
    font-size: 20px;
    border: none;
    border-radius: 8px;
    background-color: #0078d7;
    color: white;
    cursor: pointer;
  }

  .tasto:hover {
    background-color: #005fa3;
  }
</style>

<script>
  let codiceInserito = "";

  function inserisciNumero(num) {
    if (codiceInserito.length < 4) {
      codiceInserito += num;
      aggiornaDisplay();
    }
  }

  function cancellaCodice() {
    codiceInserito = codiceInserito.slice(0, -1);
    aggiornaDisplay();
  }

  function aggiornaDisplay() {
    const display = document.getElementById('display-codice');
    display.textContent = codiceInserito.padEnd(4, '_');
  }

  function verificaCodice() {
    if (codiceInserito === "1111") {
      document.getElementById('schermata-accesso').style.display = 'none';
      mostraSezione('manuale');
    } else {
      alert("Codice errato.");
      codiceInserito = "";
      aggiornaDisplay();
    }
  }
</script>

<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>RCTouchBell - Manuale</title>
  <style>
    body {
      font-family: Georgia, serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 20px;
      color: #333;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo {
      font-size: 28px;
      font-weight: bold;
    }

    .orario {
      font-size: 36px;
      margin-top: 10px;
    }

    .data {
      font-size: 18px;
      margin-top: 5px;
    }

    .sezione {
      margin: 30px 0;
    }

    .sezione h2 {
      font-size: 20px;
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .icone {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
    }

    .campana, .campana-verde, .martello {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      background-color: white;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .campana-verde {
      background-color: #c6f0c6;
    }

    .martello::before {
      content: "üî®";
    }

    .campana::before,
    .campana-verde::before {
      content: "üîî";
    }

    .registra {
      display: block;
      margin: 0 auto;
      margin-top: 30px;
      padding: 10px 30px;
      font-size: 16px;
      background-color: #0078d7;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .registra:hover {
      background-color: #005fa3;
    }

    .barra-inferiore {
      display: flex;
      justify-content: space-around;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #ccc;
    }

    .barra-inferiore button {
      background-color: #e0e0e0;
      border: none;
      padding: 10px 20px;
      font-size: 14px;
      border-radius: 6px;
      cursor: pointer;
    }

    .barra-inferiore button.active {
      background-color: #0078d7;
      color: white;
    }

    .hidden {
      display: none;
    }

    .evento, .suonata {
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }

    .azioni {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .azioni button {
      padding: 6px 12px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .azioni button.rinomina {
      background-color: #0078d7;
      color: white;
    }

    .azioni button.elimina {
      background-color: #d9534f;
      color: white;
    }

    .form-section {
      max-width: 400px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    select, input[type="number"], input[type="time"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    .salva, .aggiungi {
      margin-top: 25px;
      width: 100%;
      padding: 10px;
      font-size: 16px;
      background-color: #0078d7;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .salva:hover, .aggiungi:hover {
      background-color: #005fa3;
    }

    .configurazione {
      margin-top: 30px;
      text-align: center;
      font-size: 16px;
    }
  </style>
</head>
<body>

  <header>
    <div class="logo">RCTouchBell</div>
    <div class="orario" id="orologio">--:--:--</div>
    <div class="data" id="data">--/--/----</div>
  </header>

  <!-- Sezione: Suono Manuale -->
  <div id="sezione-manuale">
    <div class="sezione">
      <h2>Campane a Distesa</h2>
      <div class="icone" id="distesa">
        <div class="campana" data-num="1"></div>
        <div class="campana" data-num="2"></div>
        <div class="campana" data-num="3"></div>
        <div class="campana" data-num="4"></div>
        <div class="campana" data-num="5"></div>
        <div class="campana" data-num="6"></div>
        <div class="campana" data-num="7"></div>
        <div class="campana" data-num="8"></div>
      </div>
    </div>

    <div class="sezione">
      <h2>Campane a Concerto</h2>
      <div class="icone" id="concerto">
        <div class="campana-verde" data-num="1"></div>
        <div class="campana-verde" data-num="2"></div>
        <div class="campana-verde" data-num="3"></div>
        <div class="campana-verde" data-num="4"></div>
        <div class="campana-verde" data-num="5"></div>
        <div class="campana-verde" data-num="6"></div>
        <div class="campana-verde" data-num="7"></div>
        <div class="campana-verde" data-num="8"></div>
      </div>
    </div>

    <div class="sezione">
      <h2>Martelli</h2>
      <div class="icone" id="martelli">
        <div class="martello" data-num="1"></div>
        <div class="martello" data-num="2"></div>
        <div class="martello" data-num="3"></div>
        <div class="martello" data-num="4"></div>
        <div class="martello" data-num="5"></div>
        <div class="martello" data-num="6"></div>
        <div class="martello" data-num="7"></div>
        <div class="martello" data-num="8"></div>
      </div>
    </div>

    <button class="registra">REGISTRA</button>
  </div><!-- Sezione: Elenco Suoni -->
  <div id="sezione-elenco" class="hidden">
    <h2>Elenco Suonate Registrate</h2>
    <div id="elenco-suoni"></div>
  </div>

  <!-- Sezione: Programmazione -->
  <div id="sezione-programmazione" class="hidden">
    <h2>Programmazione Suonate</h2>
    <div class="form-section">
      <label for="giorno">Giorno della settimana</label>
      <select id="giorno">
        <option value="Luned√¨">Luned√¨</option>
        <option value="Marted√¨">Marted√¨</option>
        <option value="Mercoled√¨">Mercoled√¨</option>
        <option value="Gioved√¨">Gioved√¨</option>
        <option value="Venerd√¨">Venerd√¨</option>
        <option value="Sabato">Sabato</option>
        <option value="Domenica">Domenica</option>
      </select>

      <label for="ora">Ora</label>
      <input type="time" id="ora">

      <label for="tipo">Tipo di suonata</label>
      <select id="tipo">
        <option value="distesa">Campana a Distesa</option>
        <option value="concerto">Campana a Concerto</option>
        <option value="martello">Martello</option>
      </select>

      <label for="campanaProg">Campana</label>
      <select id="campanaProg">
        <option value="1">Campana 1</option>
        <option value="2">Campana 2</option>
        <option value="3">Campana 3</option>
        <option value="4">Campana 4</option>
        <option value="5">Campana 5</option>
        <option value="6">Campana 6</option>
        <option value="7">Campana 7</option>
        <option value="8">Campana 8</option>
      </select>

      <button class="aggiungi">AGGIUNGI PROGRAMMAZIONE</button>
    </div>
    <div id="elenco-eventi"></div>
  </div>

  <!-- Sezione: Battito Ore -->
  <div id="sezione-battito" class="hidden">
    <h2>Impostazioni Battito Ore</h2>
    <div class="form-section">
      <label for="campanaBattito">Campana da usare</label>
      <select id="campanaBattito">
        <option value="1">Campana 1</option>
        <option value="2">Campana 2</option>
        <option value="3">Campana 3</option>
        <option value="4">Campana 4</option>
        <option value="5">Campana 5</option>
        <option value="6">Campana 6</option>
        <option value="7">Campana 7</option>
        <option value="8">Campana 8</option>
      </select>

      <label for="oraInizio">Escludi dalle ore</label>
      <input type="number" id="oraInizio" min="0" max="23" placeholder="es. 22">

      <label for="oraFine">Alle ore</label>
      <input type="number" id="oraFine" min="0" max="23" placeholder="es. 7">

      <button class="salva">SALVA IMPOSTAZIONI</button>
    </div>
    <div class="configurazione" id="configurazione"></div>
  </div>

  <!-- Barra di navigazione -->
  <div class="barra-inferiore">
    <button onclick="mostraSezione('elenco')">ELENCO SUONI</button>
    <button onclick="mostraSezione('manuale')" class="active">SUONO MANUALE</button>
    <button onclick="mostraSezione('programmazione')">PROGRAMMAZIONE</button>
    <button onclick="mostraSezione('battito')">BATTITO ORE</button>
  </div>

  <!-- Script -->
  <script>
    // Orologio
    function aggiornaOrologio() {
      const ora = new Date();
      const hh = String(ora.getHours()).padStart(2, '0');
      const mm = String(ora.getMinutes()).padStart(2, '0');
      const ss = String(ora.getSeconds()).padStart(2, '0');
      document.getElementById('orologio').textContent = `${hh}:${mm}:${ss}`;

      const giorno = String(ora.getDate()).padStart(2, '0');
      const mese = String(ora.getMonth() + 1).padStart(2, '0');
      const anno = ora.getFullYear();
      document.getElementById('data').textContent = `${giorno}/${mese}/${anno}`;
    }

    setInterval(aggiornaOrologio, 1000);
    aggiornaOrologio();

    // Navigazione interna
    function mostraSezione(nome) {
      document.getElementById('sezione-manuale').classList.add('hidden');
      document.getElementById('sezione-elenco').classList.add('hidden');
      document.getElementById('sezione-programmazione').classList.add('hidden');
      document.getElementById('sezione-battito').classList.add('hidden');

      document.getElementById(`sezione-${nome}`).classList.remove('hidden');

      document.querySelectorAll('.barra-inferiore button').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.barra-inferiore button[onclick*="${nome}"]`).classList.add('active');

      if (nome === 'elenco') renderElenco();
      if (nome === 'programmazione') renderEventi();
      if (nome === 'battito') mostraConfigurazione();
    }

    // Suono manuale
    let suonataCorrente = [];

    function registraClick(tipo, numero, elemento) {
      suonataCorrente.push({ tipo, numero });
      elemento.style.backgroundColor = '#ffd700';
      setTimeout(() => {
        elemento.style.backgroundColor = '';
      }, 300);
    }

    document.querySelectorAll('.campana').forEach(el => {
      el.addEventListener('click', () => {
        registraClick('distesa', el.dataset.num, el);
      });
    });

    document.querySelectorAll('.campana-verde').forEach(el => {
      el.addEventListener('click', () => {
        registraClick('concerto', el.dataset.num, el);
      });
    });

    document.querySelectorAll('.martello').forEach(el => {
      el.addEventListener('click', () => {
        registraClick('martello', el.dataset.num, el);
      });
    });

    document.querySelector('.registra').addEventListener('click', () => {
      if (suonataCorrente.length === 0) {
        alert("Nessuna suonata registrata.");
        return;
      }

      const nome = prompt("Inserisci il nome della suonata:");
      if (nome) {
        let elenco = JSON.parse(localStorage.getItem('suonate')) || [];
        elenco.push({ nome, dati: suonataCorrente });
        localStorage.setItem('suonate', JSON.stringify(elenco));
        alert(`Suonata "${nome}" salvata con successo!`);
        suonataCorrente = [];
      }
    });

    window.addEventListener('load', () => {
      const suonata = JSON.parse(localStorage.getItem('suonataDaRiprodurre'));
      if (suonata) {
        riproduciSuonata(suonata.dati);
        localStorage.removeItem('suonataDaRiprodurre');
      }
    });

    function riproduciSuonata(dati) {
      let delay = 0;
      dati.forEach(passaggio => {
        setTimeout(() => {
          let selettore = '';
          if (passaggio.tipo === 'distesa') selettore = '.campana';
          else if (passaggio.tipo === 'concerto') selettore = '.campana-verde';
          else if (passaggio.tipo === 'martello') selettore = '.martello';

          const icone = document.querySelectorAll(selettore);
          const icona = Array.from(icone).find(el => el.dataset.num == passaggio.numero);
          if (icona) {
            icona.style.backgroundColor = '#ff6666';
            setTimeout(() => {
              icona.style.backgroundColor = '';
            }, 300);
          }
        }, delay);
        delay += 500;
      });
    }

    // Elenco suoni
    function renderElenco() {
      const container = document.getElementById('elenco-suoni');
      const su
      // Elenco suoni
    function renderElenco() {
      const container = document.getElementById('elenco-suoni');
      const suonate = JSON.parse(localStorage.getItem('suonate')) || [];
      container.innerHTML = '';

      suonate.forEach((suonata, index) => {
        const div = document.createElement('div');
        div.className = 'suonata';

        const titolo = document.createElement('h3');
        titolo.textContent = suonata.nome;
        div.appendChild(titolo);

        const azioni = document.createElement('div');
        azioni.className = 'azioni';

        const btnRinomina = document.createElement('button');
        btnRinomina.className = 'rinomina';
        btnRinomina.textContent = 'Rinomina';
        btnRinomina.onclick = () => {
          const nuovoNome = prompt("Nuovo nome:", suonata.nome);
          if (nuovoNome) {
            suonate[index].nome = nuovoNome;
            localStorage.setItem('suonate', JSON.stringify(suonate));
            renderElenco();
          }
        };

        const btnElimina = document.createElement('button');
        btnElimina.className = 'elimina';
        btnElimina.textContent = 'Elimina';
        btnElimina.onclick = () => {
          if (confirm(`Eliminare la suonata "${suonata.nome}"?`)) {
            suonate.splice(index, 1);
            localStorage.setItem('suonate', JSON.stringify(suonate));
            renderElenco();
          }
        };

        const btnRiproduci = document.createElement('button');
        btnRiproduci.textContent = 'Riproduci';
        btnRiproduci.onclick = () => {
          riproduciSuonata(suonata.dati);
        };

        azioni.appendChild(btnRinomina);
        azioni.appendChild(btnElimina);
        azioni.appendChild(btnRiproduci);
        div.appendChild(azioni);

        container.appendChild(div);
      });
    }

    // Programmazione
    let eventi = JSON.parse(localStorage.getItem('programmazioni')) || [];

    function salvaEventi() {
      localStorage.setItem('programmazioni', JSON.stringify(eventi));
    }

    function renderEventi() {
      const elencoDiv = document.getElementById('elenco-eventi');
      elencoDiv.innerHTML = '';
      eventi.forEach((evento, index) => {
        const div = document.createElement('div');
        div.className = 'evento';

        const titolo = document.createElement('h3');
        titolo.textContent = `${evento.nome || evento.tipo} - ${evento.giorno} alle ${evento.ora}`;
        div.appendChild(titolo);

        const dettagli = document.createElement('p');
        dettagli.textContent = `Campana ${evento.campana}`;
        div.appendChild(dettagli);

        const azioni = document.createElement('div');
        azioni.className = 'azioni';

        const btnRinomina = document.createElement('button');
        btnRinomina.className = 'rinomina';
        btnRinomina.textContent = 'Rinomina';
        btnRinomina.onclick = () => {
          const nuovoNome = prompt("Nuovo nome per l'evento:", evento.nome || evento.tipo);
          if (nuovoNome) {
            eventi[index].nome = nuovoNome;
            salvaEventi();
            renderEventi();
          }
        };

        const btnElimina = document.createElement('button');
        btnElimina.className = 'elimina';
        btnElimina.textContent = 'Elimina';
        btnElimina.onclick = () => {
          if (confirm("Eliminare questa programmazione?")) {
            eventi.splice(index, 1);
            salvaEventi();
            renderEventi();
          }
        };

        azioni.appendChild(btnRinomina);
        azioni.appendChild(btnElimina);
        div.appendChild(azioni);

        elencoDiv.appendChild(div);
      });
    }

    document.querySelector('.aggiungi').addEventListener('click', () => {
      const giorno = document.getElementById('giorno').value;
      const ora = document.getElementById('ora').value;
      const tipo = document.getElementById('tipo').value;
      const campana = document.getElementById('campanaProg').value;

      if (!ora) {
        alert("Inserisci un'ora valida.");
        return;
      }

      eventi.push({ giorno, ora, tipo, campana });
      salvaEventi();
      renderEventi();
    });

    // Battito ore
    function salvaImpostazioni() {
      const campana = document.getElementById('campanaBattito').value;
      const oraInizio = parseInt(document.getElementById('oraInizio').value);
      const oraFine = parseInt(document.getElementById('oraFine').value);

      if (isNaN(oraInizio) || isNaN(oraFine)) {
        alert("Inserisci ore valide.");
        return;
      }

      const impostazioni = {
        campana,
        esclusione: { dalle: oraInizio, alle: oraFine }
      };

      localStorage.setItem('battitoOre', JSON.stringify(impostazioni));
      mostraConfigurazione();
      alert("Impostazioni salvate.");
    }

    function mostraConfigurazione() {
      const dati = JSON.parse(localStorage.getItem('battitoOre'));
      const configurazioneDiv = document.getElementById('configurazione');
      if (dati) {
        configurazioneDiv.innerHTML = `
          <p><strong>Campana selezionata:</strong> Campana ${dati.campana}</p>
          <p><strong>Esclusione oraria:</strong> dalle ${dati.esclusione.dalle}:00 alle ${dati.esclusione.alle}:00</p>
        `;
      } else {
        configurazioneDiv.textContent = "Nessuna impostazione salvata.";
      }
    }

    document.querySelector('.salva').addEventListener('click', salvaImpostazioni);
  </script>
</body>
</html> // Battito ore automatico
setInterval(() => {
  const ora = new Date();
  const minuti = ora.getMinutes();
  const secondi = ora.getSeconds();

  if (minuti === 0 && secondi === 0) {
    const impostazioni = JSON.parse(localStorage.getItem('battitoOre'));
    if (impostazioni) {
      const oraAttuale = ora.getHours();
      const { dalle, alle } = impostazioni.esclusione;
      const escluso = dalle < alle
        ? oraAttuale >= dalle && oraAttuale < alle
        : oraAttuale >= dalle || oraAttuale < alle;

      if (!escluso) {
        const battiti = oraAttuale === 0 ? 12 : oraAttuale;
        for (let i = 0; i < battiti; i++) {
          setTimeout(() => {
            evidenziaBattito(impostazioni.campana);
          }, i * 1000);
        }
      }
    }
  }
}, 1000);

function evidenziaBattito(num) {
  const campana = document.querySelector(`.campana[data-num="${num}"]`);
  if (campana) {
    campana.style.backgroundColor = '#ff6666';
    setTimeout(() => {
      campana.style.backgroundColor = '';
    }, 300);
  }
}

// Programmazione automatica
setInterval(() => {
  const ora = new Date();
  const hhmm = `${String(ora.getHours()).padStart(2, '0')}:${String(ora.getMinutes()).padStart(2, '0')}`;
  const giornoSettimana = ["Domenica", "Luned√¨", "Marted√¨", "Mercoled√¨", "Gioved√¨", "Venerd√¨", "Sabato"][ora.getDay()];
  const eventi = JSON.parse(localStorage.getItem('programmazioni')) || [];

  eventi.forEach(evento => {
    if (evento.giorno === giornoSettimana && evento.ora === hhmm) {
      evidenziaProgrammazione(evento.tipo, evento.campana);
    }
  });
}, 60000);

function evidenziaProgrammazione(tipo, num) {
  let selettore = tipo === 'distesa' ? '.campana'
                 : tipo === 'concerto' ? '.campana-verde'
                 : '.martello';

  const campana = document.querySelector(`${selettore}[data-num="${num}"]`);
  if (campana) {
    campana.style.backgroundColor = '#66ccff';
    setTimeout(() => {
      campana.style.backgroundColor = '';
    }, 500);
  }
}






